/* FrameGrid Ghost Theme - Source Styles */

/* Tailwind CSS directives */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom CSS variables for Ghost theme integration */
@layer base {
  :root {
    /* Ghost font variables for custom font support */
    --gh-font-heading: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Oxygen, Ubuntu, Cantarell, sans-serif;
    --gh-font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
      Oxygen, Ubuntu, Cantarell, sans-serif;

    /* Theme custom variables */
    --accent-color: #3b82f6;
    --grid-columns: 3;

    /* Masonry grid variables */
    --masonry-columns: 3;
    --masonry-gap: 10px;
    --masonry-gap-md: 8px;
    --masonry-gap-sm: 6px;
    --masonry-columns-md: 2;
    --masonry-columns-sm: 1;
  }

  /* Base styles that work with Tailwind */
  body {
    @apply font-gh-body text-gh-body leading-relaxed;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply font-gh-heading text-gh-heading leading-tight;
  }
}

/* Required Ghost content card classes */
@layer components {
  .kg-width-wide {
    position: relative;
    width: 85vw;
    min-width: 100%;
    margin: auto calc(50% - 50vw);
    transform: translateX(calc(50vw - 50%));
  }

  .kg-width-full {
    position: relative;
    width: 100vw;
    left: 50%;
    right: 50%;
    margin-left: -50vw;
    margin-right: -50vw;
  }

  /* Ghost content cards */
  .kg-card {
    @apply my-ghost-card;
  }

  .kg-image {
    @apply max-w-full h-auto;
  }

  .kg-gallery-container {
    @apply flex flex-col max-w-full;
  }

  .kg-gallery-row {
    @apply flex flex-row justify-center;
  }

  .kg-gallery-image {
    @apply w-full h-full object-cover;
  }

  /* Site layout */
  .site-wrapper {
    @apply min-h-screen flex flex-col;
  }

  .site-main {
    @apply flex-1;
  }

  /* Skip link for accessibility */
  .skip-link {
    @apply absolute top-[-40px] left-2 bg-accent text-white px-2 py-2 no-underline rounded z-[1000];
  }

  .skip-link:focus {
    @apply top-2;
  }

  /* Basic grid layout */
  .grid-ghost {
    @apply grid gap-4;
    grid-template-columns: repeat(var(--grid-columns, 3), 1fr);
  }

  /* Masonry portfolio grid layout */
  .masonry-portfolio {
    display: grid;
    grid-template-columns: repeat(var(--masonry-columns, 3), 1fr);
    grid-auto-rows: auto;
    gap: var(--masonry-gap, 10px);
    column-gap: var(--masonry-gap, 10px);
    row-gap: var(--masonry-gap, 10px);
    width: 100%;
  }

  /* Masonry.js specific styles - when JavaScript takes over */
  .masonry-portfolio.masonry-js-enabled {
    display: block; /* Override grid when masonry.js is active */
    position: relative;
  }

  .masonry-portfolio.masonry-js-enabled .masonry-item {
    position: absolute;
    width: calc(
      (100% - (var(--masonry-columns, 3) - 1) * var(--masonry-gap, 10px)) /
        var(--masonry-columns, 3)
    );
  }

  .masonry-item {
    break-inside: avoid;
    position: relative;
    overflow: hidden;
  }

  .masonry-item img {
    @apply w-full h-auto object-cover rounded-lg;
    display: block;
    transition: transform 0.3s ease, opacity 0.3s ease;
  }

  /* Responsive image handling within masonry grid */
  .masonry-item picture {
    @apply w-full block;
  }

  .masonry-item picture img {
    @apply w-full h-auto;
    object-fit: cover;
    object-position: center;
  }

  /* Different aspect ratio handling */
  .masonry-item.aspect-square img {
    aspect-ratio: 1/1;
    object-fit: cover;
  }

  .masonry-item.aspect-portrait img {
    aspect-ratio: 2/3;
    object-fit: cover;
  }

  .masonry-item.aspect-landscape img {
    aspect-ratio: 3/2;
    object-fit: cover;
  }

  .masonry-item.aspect-panoramic img {
    aspect-ratio: 16/9;
    object-fit: cover;
  }

  .masonry-item.aspect-xpan img {
    aspect-ratio: 65/24;
    object-fit: cover;
  }

  /* Lazy loading support */
  .masonry-item img[loading="lazy"] {
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .masonry-item img[loading="lazy"].loaded {
    opacity: 1;
  }

  /* Responsive image sizes for different viewports */
  .masonry-item img {
    max-width: 100%;
    height: auto;
  }

  @media (max-width: 768px) {
    .masonry-item img {
      border-radius: 6px;
    }
  }

  @media (max-width: 640px) {
    .masonry-item img {
      border-radius: 4px;
    }
  }

  /* Masonry spacing variants */
  .masonry-tight {
    gap: 5px;
    column-gap: 5px;
    row-gap: 5px;
  }

  .masonry-loose {
    gap: 20px;
    column-gap: 20px;
    row-gap: 20px;
  }

  .masonry-compact {
    gap: 2px;
    column-gap: 2px;
    row-gap: 2px;
  }

  /* Masonry container padding for proper alignment */
  .masonry-container {
    padding: var(--masonry-gap, 10px);
  }

  @media (max-width: 768px) {
    .masonry-container {
      padding: var(--masonry-gap-md, 8px);
    }
  }

  @media (max-width: 640px) {
    .masonry-container {
      padding: var(--masonry-gap-sm, 6px);
    }
  }

  /* Responsive grid adjustments */
  @screen md {
    .grid-ghost-3,
    .grid-ghost-4 {
      @apply grid-cols-2;
    }
  }

  @screen sm {
    .grid-ghost-2,
    .grid-ghost-3,
    .grid-ghost-4 {
      @apply grid-cols-1;
    }

    .kg-width-wide,
    .kg-width-full {
      @apply w-full my-8;
      transform: none;
      left: auto;
      right: auto;
      margin-left: 0;
      margin-right: 0;
    }
  }

  /* Masonry responsive adjustments */
  @media (max-width: 768px) {
    .masonry-portfolio {
      grid-template-columns: repeat(var(--masonry-columns-md, 2), 1fr);
      gap: var(--masonry-gap-md, 8px);
      column-gap: var(--masonry-gap-md, 8px);
      row-gap: var(--masonry-gap-md, 8px);
    }
  }

  @media (max-width: 640px) {
    .masonry-portfolio {
      grid-template-columns: repeat(var(--masonry-columns-sm, 1), 1fr);
      gap: var(--masonry-gap-sm, 6px);
      column-gap: var(--masonry-gap-sm, 6px);
      row-gap: var(--masonry-gap-sm, 6px);
    }
  }

  /* Button styles */
  .btn {
    @apply inline-block px-4 py-2 bg-accent text-white border-none rounded cursor-pointer no-underline;
  }

  .btn:hover {
    @apply opacity-90 no-underline;
  }

  .btn-primary {
    @apply btn bg-accent;
  }

  .btn-secondary {
    @apply btn bg-gray-600;
  }

  /* Container */
  .container {
    @apply max-w-ghost-wide mx-auto px-4;
  }

  /* Header and footer */
  .site-header {
    @apply py-4 border-b border-gray-200;
  }

  .site-footer {
    @apply py-8 border-t border-gray-200 mt-auto;
  }

  /* Post and page content */
  .post-content,
  .page-content {
    @apply max-w-ghost-content mx-auto py-8 px-4;
  }

  .post-content img,
  .page-content img {
    @apply my-8 rounded-lg;
  }

  /* Form styles */
  input,
  textarea,
  select {
    @apply w-full p-2 border border-gray-300 rounded;
    font-family: inherit;
  }

  /* Dark mode styles */
  @media (prefers-color-scheme: dark) {
    :root {
      --gh-color-heading: #ffffff;
      --gh-color-body: #e5e5e5;
      --gh-color-secondary: #a1a1aa;
    }

    body {
      @apply bg-gray-900 text-gray-100;
    }

    .site-header,
    .site-footer {
      @apply border-gray-700;
    }

    input,
    textarea,
    select {
      @apply bg-gray-800 border-gray-600 text-gray-100;
    }
  }

  .dark-mode {
    @apply bg-gray-900 text-gray-100;
  }

  .dark-mode .site-header,
  .dark-mode .site-footer {
    @apply border-gray-700;
  }

  .dark-mode input,
  .dark-mode textarea,
  .dark-mode select {
    @apply bg-gray-800 border-gray-600 text-gray-100;
  }

  /* Masonry loading states */
  .masonry-loading {
    @apply relative;
  }

  .masonry-loading::before {
    content: "";
    @apply absolute inset-0 bg-gray-100 animate-pulse rounded-lg;
    z-index: 1;
  }

  .masonry-loading-progress {
    @apply fixed top-4 right-4 bg-white bg-opacity-90 px-3 py-2 rounded-lg shadow-lg text-sm font-medium z-50;
  }

  .masonry-loading-progress.hidden {
    @apply opacity-0 pointer-events-none;
  }

  /* Masonry transition effects */
  .masonry-item.masonry-item-loading {
    @apply opacity-50;
  }

  .masonry-item.masonry-item-loaded {
    @apply opacity-100;
  }
}

/* Custom utilities */
@layer utilities {
  /* Screen reader only */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  .focus\:not-sr-only:focus {
    position: static;
    width: auto;
    height: auto;
    padding: 0.5rem 1rem;
    margin: 0;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }

  /* Photography-specific utilities */
  .aspect-photo {
    aspect-ratio: 3/2;
  }

  .aspect-square {
    aspect-ratio: 1/1;
  }

  .aspect-portrait {
    aspect-ratio: 2/3;
  }

  /* Masonry responsive image utilities */
  .masonry-responsive-image {
    width: 100%;
    height: auto;
    display: block;
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .masonry-responsive-image[loading="lazy"]:not(.loaded) {
    opacity: 0;
  }

  .masonry-responsive-image.loaded {
    opacity: 1;
  }

  /* Optimized image component styles */
  .optimized-image-container {
    @apply block w-full;
  }

  .optimized-image {
    @apply w-full h-auto object-cover transition-all duration-300;
  }

  .optimized-image.image-loading {
    @apply opacity-0 scale-95;
  }

  .optimized-image.image-loaded {
    @apply opacity-100 scale-100;
  }

  .optimized-image-placeholder {
    @apply flex items-center justify-center bg-gray-100 dark:bg-gray-800 rounded-lg min-h-[200px];
  }

  .optimized-image-placeholder svg {
    @apply w-full h-full text-gray-400 dark:text-gray-600;
  }

  /* Enhanced loading states for images */
  .optimized-image:not(.image-loaded) {
    @apply bg-gray-200 dark:bg-gray-700;
    background-image: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
  }

  @keyframes shimmer {
    0% {
      background-position: -200% 0;
    }
    100% {
      background-position: 200% 0;
    }
  }

  /* Critical image optimization - disable lazy loading for above-the-fold images */
  .optimized-image[fetchpriority="high"] {
    @apply opacity-100;
  }

  /* WebP support detection fallback */
  .no-webp .optimized-image-container source[type="image/webp"] {
    display: none;
  }

  /* Line clamp utility for text truncation */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Masonry overlay enhancements */
  .masonry-overlay {
    -webkit-backdrop-filter: blur(2px);
    backdrop-filter: blur(2px);
  }

  @supports not (backdrop-filter: blur(2px)) {
    .masonry-overlay {
      background-color: rgba(0, 0, 0, 0.6);
    }
  }
}
